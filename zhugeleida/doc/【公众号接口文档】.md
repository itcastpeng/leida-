[TOC]



####  1.1、【公众号 - 实时聊天-发送消息接口】

请求方式：POST（HTTP）

请求示例

>http://127.0.0.1:8000/zhugeleida/gongzhonghao/chat/send_msg/0?rand_str=8bd0ac475c5c60e46a358b3e6bcc49cf&timestamp=1537514281502&user_id=1

 GET 请求参数部分：
```  python
{
    'rand_str': account.str_encrypt(timestamp + token),
    'timestamp': timestamp,
    'user_id': 2,
}
``` 

 
POST 请求参数部分：
```  python
参数             必填        说明
customer_id      是         公众号客户ID
u_id          是            雷达用户ID
content        是        内容 

content = {
    'info_type' :  1 , # 1代表发送的文字\表情\ 或 话术库里的自定义(文字表情)。
    'msg': '这个信息是文字\表情'
}

content = {
    'info_type' : 2 , # 2代表发送的产品咨询  3代表发送的电话号码  4代表发送的图片|截图  5、视频
    'product_cover_url': 'statics/zhugeleida/imgs/chat/2d49ecd2-9180-11e8-a32d-8e2edea1cc9c.png',
    'product_name': '产品名字',
    'product_price': '产品价格',
}
content = {
    'info_type' : 3   ,   # 3代表客户要触发事件要电话号码  
    'msg': '您好,请问能否告诉我您的手机号?|您好,请问能否加下您的微信?'
    ......
}

send_type =    2     |   发送类型，2 代表 公众号客户发送给用户。
``` 
`` 
 


返回结果：
```  python
{"code": 200, "msg": "send msg successful", "data": {}}
``` 
 


####  1.2、 【 公众号 - 时聊天-获取最新的聊天信息】

请求方式：GET（HTTP）
请求示例:

>http://127.0.0.1:8000/zhugeleida/gongzhonghao/chat/getmsg/0?rand_str=b223adf172e809f5b91d2b6864788045&timestamp=1537514484951&user_id=1&u_id=1
 
 
GET 请求参数部分：

```  python
{
    'rand_str': account.str_encrypt(timestamp + token),
    'timestamp': timestamp,
    'user_id': 2,
    'u_id':  1   # 雷达用户ID
}

``` 

GET请求参数部分：

```  python
参数            必填          说明
u_id            是           要发给的雷达用户ID
user_id         是           公众号客户的ID

``` 

 返回结果：

```  python
{
    "code":200,
    "msg":"实时获取-最新聊天信息成功",
    "data":{
        "ret_data":[
            {
                "customer_id":1,
                "user_id":1,
                "user_avator":"http://shp.qpic.cn/bizmp/prSBf5AvHhAV3730YB9qjpC4Uicv4pA4JBkjhgJmjzZSBB5vSC1gmrA/",
                "customer_headimgurl":"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83epcPbQBxqzSu2qXqWuCrodTSbvlBmqJuOF1OIuMp46k9SSUvCCWZCF8Nj28TCe17NwoAib2lq14bAA/132",
                "customer":"_zzz จุ๊บ",
                "dateTime":"2018-09-21T15:18:01.548",
                "send_type":2,
                "is_first_info":false,
                "info_type":1,
                "msg":"这个信息是文字\表情"
            }
        ],
        "data_count":1
    }
}
``` 


####  1.3、【公众号 - 分页获取-所有的聊天信息记录】

请求方式：GET（HTTP）
请求示例：

>http://127.0.0.1:8000/zhugeleida/gongzhonghao/chat?rand_str=53444e4ca12d03176c9b6109c0c557b0&timestamp=1528871213546&user_id=1&customer_id=1

GET 请求参数部分：

``` python
{
    'rand_str': account.str_encrypt(timestamp + token),
    'timestamp': timestamp,
    'u_id': 2,   
    'customer_id': 1,
    'current_page'：1,            
    'length'     :   20           
}

```

GET参数说明:

``` python
参数           必填          说明
u_id           是           用户的ID
customer_id    是           客户的ID

length         否           每页长度
current_page   否           当前页数

```

返回结果：

```  python
{
    "code":200,
    "msg":"分页获取-全部聊天消息成功",
    "data":{
        "ret_data":[
            {
                "customer_id":1,
                "from_user_name":"_zzz จุ๊บ",
                "user_id":1,
                "customer":"_zzz จุ๊บ",
                "user_avatar":"http://shp.qpic.cn/bizmp/prSBf5AvHhAV3730YB9qjpC4Uicv4pA4JBkjhgJmjzZSBB5vSC1gmrA/",
                "customer_headimgurl":"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83epcPbQBxqzSu2qXqWuCrodTSbvlBmqJuOF1OIuMp46k9SSUvCCWZCF8Nj28TCe17NwoAib2lq14bAA/132",
                "dateTime":"2018-09-21T15:18:01.548",
                "send_type":2,
                "is_first_info":true,
                "info_type":1,
                "msg":"这个信息是文字\表情"
            }
        ],
        "mingpian_phone":"18932674288",
        "wechat":"18866554433",
        "data_count":1
    }
}
``` 



####   1.4、【 公众号 - 聊天 - 获取聊天数量】
请求方式：GET（HTTP）
请求示例:

>http://127.0.0.1:8000/zhugeleida/gongzhonghao/chat/query_num/0?rand_str=fda21c3109b2a3fec924da3c6f1e4d29&timestamp=1534407372677&user_id=9&u_id=1

 
 
GET 请求参数部分：

```  python
{
    'rand_str': account.str_encrypt(timestamp + token),
    'timestamp': timestamp,
    'u_id': 1,
    'user_id': 9
}

``` 

GET请求参数部分：

```  python
参数            必填         说明
u_id            是           所属用户的ID
user_id         是           用户ID
``` 

 返回结果：

```  python
{
   {
    "code":200,
    "msg":"查询成功",
    "data":{
        "chatinfo_count":1
    }
}
    
``` 


####  1.5、【企业微信 - 通讯录信息】


请求方式：GET（HTTP）
访问示例
>http://127.0.0.1:8000/zhugeleida/qiyeweixin/tongxunlu?rand_str=9b7905e5a1887cc3809e410e3847146b&timestamp=1528783998540&user_id=1


GET 请求参数部分:

``` python
    {
        'rand_str': account.str_encrypt(timestamp + token),  【公共参数】
        'timestamp': timestamp,     【公共参数】
        'user_id': 1,                【公共参数】
        
     
        'order' : '-expedted_pr' ( 默认排序）| '-last_follow_time' | '-last_activity_time' 
       
    }
```

GET请求参数部分：
```  python
参数            必填         说明
user_id         是          用户的ID

order           否          排序方式: 1、-expedted_pr 预计成交概率  2、-last_follow_time  代表最后跟进时间     -last_activity_time  后活动时间     

```
返回结果
``` python
{
    "code":200,
    "msg":"查询成功",
    "data":{
        "ret_data":[
            {
                "customer_id":886,
                "customer_username":"又胖了",  # 客户名字
                "headimgurl":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIWdR8b43407blia6uHflM9MMnzxXXlmL7NCuI7BPKy0NLS2E7HfEhwwFLWTNrKibdEbhXS8sUqwhqw/132",  # 头像URL
                "expected_time":null,  # 预计成交时间
                "expedted_pr":0,       # 预计成交概率
                "last_follow_time":"今天",  # 最后跟进时间
                "last_activity_time":"",    # 最后活动时间
                "follow_status":"今天跟进",  # 跟进状态
                "article_id":2,  # 文章ID
                "title":"jajjaj" # 文章标题
            },
            {
                "customer_id":854,
                "customer_username":"Ju do it",
                "headimgurl":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eplZzQgPbp8kI1uODkbThdUpbFMCnKTYSk6b3VjEkN673VKWaIicbCsRpPCfxHn2zBib1NYWXw1uibEg/132",
                "expected_time":null,
                "expedted_pr":0,
                "last_follow_time":"3天前",
                "last_activity_time":"今天",
                "follow_status":"2018-09-18",
                "article_id":2,
                "title":"jajjaj"
            },
            {
                "customer_id":898,
                "customer_username":"胡蓉💗Rose",
                "headimgurl":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKeBic28CibfUnsic8xGbPtCsicX1XP4LlSzCv5HgT4xmIy3APqCQwrdmUibEVUosV2uHuFXm3zwQdWVXw/132",
                "expected_time":null,
                "expedted_pr":0,
                "last_follow_time":"",
                "last_activity_time":"",
                "follow_status":"未跟进过",
                "article_id":2,
                "title":"jajjaj"
            },
            {
                "customer_id":899,
                "customer_username":"李亚龙₁₇₆₀₀₁₅₅₂₄₄大圣",
                "headimgurl":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKU1qmamaIHISykD5ib2N5nI7kGlyXddDznWhPq5csZRIHGvo1ToO46d0V3MVzk2zrKEvr0vuWOTVw/132",
                "expected_time":null,
                "expedted_pr":0,
                "last_follow_time":"",
                "last_activity_time":"",
                "follow_status":"未跟进过",
                "article_id":2,
                "title":"jajjaj"
            },
            {
                "customer_id":900,
                "customer_username":"Chesnut",
                "headimgurl":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo1iaZXQsiazianWKQjFAa0QTYcWpn0HAaOiaCaxwySjicYZicPAHzdH93iaqt5D8dKk0c1ia0BjniaxfeicIpQ/132",
                "expected_time":null,
                "expedted_pr":0,
                "last_follow_time":"",
                "last_activity_time":"",
                "follow_status":"未跟进过",
                "article_id":2,
                "title":"jajjaj"
            },
            {
                "customer_id":901,
                "customer_username":"米多面多（永年店）",
                "headimgurl":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epPJBibCzw66FYho9Ze2rV8WTEgI41aCKEtMNyseq1PpC1vT5e8eSV401fBH54wbT9cqbQib8zoh3icA/132",
                "expected_time":null,
                "expedted_pr":0,
                "last_follow_time":"",
                "last_activity_time":"",
                "follow_status":"未跟进过",
                "article_id":2,
                "title":"jajjaj"
            },
            {
                "customer_id":902,
                "customer_username":"常韵杰",
                "headimgurl":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKiawicPkt8G5sMbKibkd8rblYtM7S8TqQmElvvRib9bJf6dGTDIqAB0L4BCwbss5RuKFeJMm7WKI49uA/132",
                "expected_time":null,
                "expedted_pr":0,
                "last_follow_time":"",
                "last_activity_time":"",
                "follow_status":"未跟进过",
                "article_id":2,
                "title":"jajjaj"
            },
            {
                "customer_id":904,
                "customer_username":"Bill",
                "headimgurl":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJaE04zqHeBMLY2JAvTcudDMgxYmu1B9bvWkB1nC0Jq0KucD2Atia5T3GysD3ibxvOrVjSzpD3TmQnQ/132",
                "expected_time":null,
                "expedted_pr":0,
                "last_follow_time":"",
                "last_activity_time":"",
                "follow_status":"未跟进过",
                "article_id":2,
                "title":"jajjaj"
            },
            {
                "customer_id":862,
                "customer_username":"修炼爱情的悲欢",
                "headimgurl":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIOQaLUnW7A2mN6N7lt3zh5Siao9LVic6ZbByeeHias5CWIjxuhM382xmTtWZN78rWZ43F5ZKheNbiahQ/132",
                "expected_time":null,
                "expedted_pr":0,
                "last_follow_time":"",
                "last_activity_time":"",
                "follow_status":"未跟进过",
                "article_id":2,
                "title":"jajjaj"
            },
            {
                "customer_id":905,
                "customer_username":"梦魇",
                "headimgurl":"http://thirdwx.qlogo.cn/mmopen/vi_32/OmfnbsH0TicJB3z8MLVElfgicwlpLf7QLhIgLBgW5f1uUp6Xceg3LILWrA0zjYq2ibDw95CVgel4AVv36t9mj7hWg/132",
                "expected_time":null,
                "expedted_pr":0,
                "last_follow_time":"",
                "last_activity_time":"",
                "follow_status":"未跟进过",
                "article_id":2,
                "title":"jajjaj"
            }
        ],
        "data_count":21
    }
}
```

####  1.6、【企业微信 - 查询单个-客户信息】

GET 请求发送数据部分：

``` python
{
    'rand_str': account.str_encrypt(timestamp + token),
    'timestamp': timestamp,
    'user_id': 1,  				#   客户ID
    'customer_id'；2   			# 用户ID  
}
```


访问示例:
 
>http://127.0.0.1:8000/zhugeleida/qiyeweixin/customer      #查询-单个客户信息


返回结果：

``` python
{
    "code":200,
    "msg":"查询成功",
    "data":{
        "ret_data":[
            {
                "id":1,
                "username":"张炬[客户2]",       #客户名称  
                "headimgurl":"statics/imgs/setAvator.jpg",
                "expected_time":"2018-06-14",   #预计成交时间
                "expedted_pr":"80",             # 预计成交概率
                "ai_pr":"80",                   # AI 成交率
                "superior":"张聪[客户1]",       # 上级人
                "source":"扫码",                # 客户通过扫码方式来关注此用户。
                "memo_name":null,               # 客户的备注名
                "phone":"",                     #  客户的手机号
                "email":"",                     # 邮箱 
                "company":"",                   # 在职公司
                "position":"",                  # 所在职位
                "address":"",                   # 客户所在的住址 
                "birthday":"",                  # 客户的生日
                "mem":"",                       # 客户个人信息备注等  
                "tag":[                         #客户的标签
                    "在意质量",
                    "一般客户",
                    "重要客户",
                    "已婚",
                    "爱撸串",
                    "90后",
                    "爱吃串"
                ]
            }
        ],
        "data_count":1
    }
}
  
```

####  1.7、【企业微信 -  修改客户关联信息】

请求方式：POST（HTTP）
请求示例:
>http://127.0.0.1:8000/zhugeleida/qiyeweixin/customer/update_information/2?rand_str=4c75edb76b06a2983040980f171b83e7&timestamp=1528169127235&user_id=1


GET 请求发送数据部分：
``` python
{
    'rand_str': account.str_encrypt(timestamp + token),
    'timestamp': timestamp,
    'user_id': 1,
}
```  
POST 请求数据部分:
 
``` python
{
   
   'username' : '张三丰',
   'superior' : 1,
   'sex' : 1 ,
   'memo_name' : '太乙真人',
   'phone': '15931788974',
   'email' : '1224423@qq.com',
   'company': '合众康桥',
   'position': '开发TTT',
   'address' : '通州区xxx',
   'mem' : '我是一个兵',
   'birthday' : '2018-06-1'
   
}
```

POST参数说明：

``` python
参数        必填          说明
id          是           客户ID
sex         是           1代表男 2 代表女

username    否           客户名【备注名】
password    否           密码
email       否           电子邮件
company     否           客户所属公司
position    否           职位
address     否           住址
birthday    否           生日
mem         否           备注
```

返回结果：   

{"code": 200, "msg": "\u6dfb\u52a0\u6210\u529f", "data": {}}
 
 
####  1.7、【企业微信 -  修改客户预成交时间】

请求方式：POST（HTTP）
请求示例:
>http://127.0.0.1:8000/zhugeleida/qiyeweixin/customer/update_expected_time/1?rand_str=4c75edb76b06a2983040980f171b83e7&timestamp=1528169127235&user_id=1
 

GET 请求发送数据部分【公共参数】：

``` python
{
    'rand_str': account.str_encrypt(timestamp + token),
    'timestamp': timestamp,
    'user_id': 1,
}
 
```  
URl参数说明：

``` python
参数															说明
/zhugeleida/qiyeweixin/customer/update_expected_time/{ID}   客户ID
```

 
POST 请求数据部分:

``` python
{
   'expected_time':  '2018-06-06'
}
```
   
POST参数说明：

``` python
参数            必填          说明
expected_time   否           成交时间

``` 

返回结果：

``` python
{"code": 200, "msg": "\u6dfb\u52a0\u6210\u529f", "data": {}}

``` 


 
####  1.8、【企业微信 -  修改客户预成交率】

请求方式：POST（HTTP）
请求示例:
>http://127.0.0.1:8000/zhugeleida/qiyeweixin/customer/update_expected_pr/1?rand_str=4c75edb76b06a2983040980f171b83e7&timestamp=1528169127235&user_id=1
 

GET 请求发送数据部分【公共参数】：

``` python
{
    'rand_str': account.str_encrypt(timestamp + token),
    'timestamp': timestamp,
    'user_id': 1,
}
 
```  
URl参数说明：

``` python
参数															说明
/zhugeleida/qiyeweixin/customer/update_expected_pr/{ID}   客户ID
```

 
POST 请求数据部分:

``` python
{
   'expedted_pr' :  80,
}
```
   
POST参数说明：

``` python
参数            必填          说明
expedted_pr     否           成交率

``` 

返回结果：

``` python
{"code": 200, "msg": "\u6dfb\u52a0\u6210\u529f", "data": {}}

``` 


####  1.9、【企业微信 -  修改客户标签】

请求方式：POST（HTTP）
请求示例:
>http://127.0.0.1:8000/zhugeleida/qiyeweixin/customer/update_tag/1?rand_str=4c75edb76b06a2983040980f171b83e7&timestamp=1528169127235&user_id=1
 

GET 请求发送数据部分【公共参数】：

``` python
{
    'rand_str': account.str_encrypt(timestamp + token),
    'timestamp': timestamp,
    'user_id': 1,
}
 
```  
URl参数说明：

``` python
参数															说明
/zhugeleida/qiyeweixin/customer/update_tag/{ID}   客户ID
```

 
POST 请求数据部分:

``` python
{
  'tag_list' :   [2,3],  		# json修列化 标签ID，为空可以传 []
}
```
   


返回结果：

``` python
{"code": 200, "msg": "\u6dfb\u52a0\u6210\u529f", "data": {}}

``` 



####  【企业微信-雷达】 按时间展示访问日志

请求方式：GET（HTTP）
访问示例
>http://127.0.0.1:8000/zhugeleida/qiyeweixin/action/time?length=10&current_page=1&customer_id=60&rand_str=18440ec408ae9ba825651358e29f35d3&timestamp=1537603223134&user_id=55


GET 请求参数部分【公共参数】
```  python
{
    'rand_str': account.str_encrypt(timestamp + token),
    'timestamp': timestamp,
    'user_id': 1,
    'customer_id': 60,

}
```



返回结果：
```  python
{
    "code":200,
    "msg":"查询日志记录成功",
    "data":{
        "ret_data":[
            {
                "user_id":1,
                "customer_id":2,
                "headimgurl":"statics/imgs/setAvator.jpg",
                "log":"张聪觉得靠谱",
                "create_date":"2018-06-19T10:03:29"
            },
            {
                "user_id":1,
                "customer_id":2,
                "headimgurl":"statics/imgs/setAvator.jpg",
                "log":"张聪访问了产品",
                "create_date":"2018-06-09T14:01:34"
            },
            {
                "user_id":1,
                "customer_id":2,
                "headimgurl":"statics/imgs/setAvator.jpg",
                "log":"张聪访问您的产品",
                "create_date":"2018-06-09T10:03:29"
            },
            {
                "user_id":1,
                "customer_id":1,
                "headimgurl":"statics/imgs/setAvator.jpg",
                "log":"张炬又一次访问了您的名片，他娘的。",
                "create_date":"2018-06-09T10:02:12"
            },
            {
                "user_id":1,
                "customer_id":2,
                "headimgurl":"statics/imgs/setAvator.jpg",
                "log":"张聪访问了产品",
                "create_date":"2018-06-09T10:01:34"
            }
        ],
        "data_count":36
    }
}
```